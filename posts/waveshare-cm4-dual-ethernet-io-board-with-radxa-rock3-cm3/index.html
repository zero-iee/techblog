<!doctype html><html lang=de-de data-theme><head><meta charset=utf-8><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><title>Waveshare CM4 Dual Gigabit Ethernet 5G/4G Base Board mit Radxa Rock 3 CM3 Compute Module in Betrieb nehmen - ZERO GmbH Tech Blog</title><meta name=description content="Da da Raspberry Pi CM4 (&ldquo;Compute Module&rdquo;) seit längerer Zeit wegen der anhaltenden Lieferkettenprobleme schwer und nur in geringen Stückzahlen zu beschaffen ist, haben wir von der ZERO GmbH uns nach einer Alternative umgesehen.
Obwohl der Name es nicht direkt vermuten lässt, bietet Radxa mit dem &ldquo;Rock3 CM3&rdquo; eine weitestgehend Pin-kompatible Alternative zum Raspberry Pi CM4 an. &ldquo;Weitestgehend&rdquo;, da Radxa über einen zusätzlichen, dritten Sockel weitere Pins für Radxa-spezifische Features anbietet."><link rel=icon type=image/x-icon href=https://blog.zero-iee.com/favicon.ico><link rel=apple-touch-icon-precomposed href=https://blog.zero-iee.com/favicon.png><style>body{visibility:hidden;opacity:0}</style><noscript><style>body{visibility:visible;opacity:1}</style></noscript><link rel=stylesheet href=https://blog.zero-iee.com/css/style.min.d0d70677a1f8d8becbb30542d422e855861ed7b28450fbb6017c58b7c410803a.css integrity="sha256-0NcGd6H42L7LswVC1CLoVYYe17KEUPu2AXxYt8QQgDo="><script src=https://blog.zero-iee.com/js/script.min.74bf1a3fcf1af396efa4acf3e660e876b61a2153ab9cbe1893ac24ea6d4f94ee.js type=text/javascript integrity="sha256-dL8aP88a85bvpKzz5mDodrYaIVOrnL4Yk6wk6m1PlO4="></script><meta property="og:title" content="Waveshare CM4 Dual Gigabit Ethernet 5G/4G Base Board mit Radxa Rock 3 CM3 Compute Module in Betrieb nehmen"><meta property="og:description" content="Da da Raspberry Pi CM4 (&ldquo;Compute Module&rdquo;) seit längerer Zeit wegen der anhaltenden Lieferkettenprobleme schwer und nur in geringen Stückzahlen zu beschaffen ist, haben wir von der ZERO GmbH uns nach einer Alternative umgesehen.
Obwohl der Name es nicht direkt vermuten lässt, bietet Radxa mit dem &ldquo;Rock3 CM3&rdquo; eine weitestgehend Pin-kompatible Alternative zum Raspberry Pi CM4 an. &ldquo;Weitestgehend&rdquo;, da Radxa über einen zusätzlichen, dritten Sockel weitere Pins für Radxa-spezifische Features anbietet."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.zero-iee.com/posts/waveshare-cm4-dual-ethernet-io-board-with-radxa-rock3-cm3/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-22T09:56:25+01:00"><meta property="article:modified_time" content="2023-03-22T09:56:25+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Waveshare CM4 Dual Gigabit Ethernet 5G/4G Base Board mit Radxa Rock 3 CM3 Compute Module in Betrieb nehmen"><meta name=twitter:description content="Da da Raspberry Pi CM4 (&ldquo;Compute Module&rdquo;) seit längerer Zeit wegen der anhaltenden Lieferkettenprobleme schwer und nur in geringen Stückzahlen zu beschaffen ist, haben wir von der ZERO GmbH uns nach einer Alternative umgesehen.
Obwohl der Name es nicht direkt vermuten lässt, bietet Radxa mit dem &ldquo;Rock3 CM3&rdquo; eine weitestgehend Pin-kompatible Alternative zum Raspberry Pi CM4 an. &ldquo;Weitestgehend&rdquo;, da Radxa über einen zusätzlichen, dritten Sockel weitere Pins für Radxa-spezifische Features anbietet."></head><body><a class=skip-main href=#main>Zum Hauptinhalt springen</a><div class=container><header class=common-header><div class=header-top><div class=header-logo></div><h1 class=site-title><a href=/>ZERO GmbH Tech Blog</a></h1><ul class=social-icons><li><a href=https://github.com/zero-iee title=Github rel=me><span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></a></li><li><a href=https://de.linkedin.com/company/zero-iee title=Linkedin rel=me><span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a></li></ul></div><nav></nav></header><main id=main tabindex=-1><article class="post h-entry"><div class=post-header><header><h1 class="p-name post-title">Waveshare CM4 Dual Gigabit Ethernet 5G/4G Base Board mit Radxa Rock 3 CM3 Compute Module in Betrieb nehmen</h1></header></div><div class="content e-content"><p>Da da Raspberry Pi CM4 (&ldquo;Compute Module&rdquo;) seit längerer Zeit wegen der anhaltenden Lieferkettenprobleme schwer und nur in geringen Stückzahlen zu beschaffen ist, haben wir von der ZERO GmbH uns nach einer Alternative umgesehen.</p><p>Obwohl der Name es nicht direkt vermuten lässt, bietet Radxa mit dem &ldquo;<a href=https://wiki.radxa.com/Rock3/CM/CM3>Rock3 CM3</a>&rdquo; eine weitestgehend Pin-kompatible Alternative zum Raspberry Pi CM4 an. <em>&ldquo;Weitestgehend&rdquo;</em>, da Radxa über einen zusätzlichen, dritten Sockel weitere Pins für Radxa-spezifische Features anbietet. Weitere Interschiede sind auf <a href=https://wiki.radxa.com/Rock3/CM3/vsCM4>dieser Seite in der Tabelle</a> zu finden. Dennoch lässt sich das Radxa CM3 Modul hardwareseitig problemlos in ein bestehendes Raspberry Pi CM4 IO-Board einbauen - in unserem Fall ein <a href=https://www.waveshare.com/CM4-DUAL-ETH-4G-5G-BASE.htm>Waveshare Dual Gigabit Ethernet 5G/4G Base Board</a>.</p><p>Auch wenn die Schnittstelle zwischen CM und Base IO Board nahezu identisch ist - der SoC auf dem Compute Module ist es keinesfalls. Während das CM4 der Raspberry Foundation auf einen Broadcom SoC (BCM2711) setzt, kommt auf dem Radxa Rock3 CM3 ein Rockchip-SoC (RK3566) zum Einsatz. Die Software kann also nicht 1:1 übertragen werden. Ein Raspbian oder Raspberry Pi OS auf dem Rockchip auszuführen, ist also nicht möglich.</p><p>Stattdessen bietet Radxa ein paar für den Rockchip geeignete Betriebssysteme zum Download an. Darunter auch eine Debian 11 (&ldquo;Bullyeye&rdquo;) Version, deren Kernel auf den Rockchip-SoC angepasst ist. Leider kommt die Linux-Distribution mit dem Uraltkernel 4.19 - das soll hier aber erst einmal nicht weiter stören.</p><p>Die <a href=https://wiki.radxa.com/Rock3/downloads>Downloadseite</a> verweist auf GitHub Releaseseiten. Von dort aus kann die passende Debian-Version heruntergeladen werden. Da wir allerdings nicht das Radxa-eigene IO Board nutzen, sondern das Waveshare IO Board, welches für ein original CM4 konzipiert wurde, ist beim Download Vorsicht geboten: Hier muss die Version für ein &ldquo;RASPCM4IO&rdquo; board heruntergeladen werden. Das Image <code>radxa-cm3-io-debian-bullseye-xfce4-arm64-&lt;VERSION>-gpt.img.xz</code> ist also das passende (GitHub: <a href=https://github.com/radxa-build/radxa-cm3-io/releases/tag/20221101-0118>Download</a>).</p><p>Nun aber zu den konkreten Schritten für das Aufspielen des Debian-Images auf den eMMC Flash des Rock3 CM3 - unter Ubuntu Linux als Host. &mldr;</p><h2 id=rkdeveloptool-herunterladen-und-installieren>rkdeveloptool herunterladen und installieren
<span><a href=#rkdeveloptool-herunterladen-und-installieren><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h2><p>Da wir auf eine SD-Karte verzichten und das OS-Image direkt in den onboard-eMMC Speicher des CM3 schreiben wollen, benötigen wir zunächst das passende Entwicklerwerkzeug von Rockchip, mit dem sich derartige Schreibbvorgänge umsetzen lassen.</p><p>Das passende Tool heißt <code>rkdeveloptool</code> und kann von GitHub heruntergeladen werden:</p><pre><code>git clone https://github.com/rockchip-linux/rkdeveloptool.git
</code></pre><p>Für den Kompiliervorgang müssen einige Pakete auf dem Host installiert sein:</p><pre><code>sudo apt-get install build-essential libudev-dev libusb-1.0-0-dev dh-autoreconf
</code></pre><p>Danach wird es aus dem Sourcecode kompiliert und installiert:</p><pre><code>cd rkdeveloptool
autoreconf -i
./configure
make
sudo make install
</code></pre><h2 id=os-image-in-emmc-schreiben>OS-Image in eMMC schreiben
<span><a href=#os-image-in-emmc-schreiben><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h2><p>Nun wird auf dem Waveshare IO Board der &ldquo;Boot&rdquo; Schalter auf &ldquo;on&rdquo; gestellt und das Board mit einem USB-C-Kabel zum Hostrechner verbunden. Ein <code>lsusb</code> auf der Kommandozeile sollte offenbaren, dass ein Gerät von &ldquo;Fuzhou Rockchip Electronics Company&rdquo; erkannt wurde:</p><pre><code>Bus 003 Device 005: ID 2207:350a Fuzhou Rockchip Electronics Company 
</code></pre><p>Nun laden wir uns den Rockchip Loader herunter; eine Softwarekomponente, die in den RAM des SoC geladen wird, sodass wir von dort aus das Debian-Image in den eMMC Flash schreiben können:</p><pre><code>wget https://dl.radxa.com/rock3/images/loader/rock-3a/rk356x_spl_loader_ddr1056_v1.10.111.bin
</code></pre><p>Der Loader wird nun über das rkdeveloptool in den RAM des SoC übertragen:</p><pre><code>sudo rkdeveloptool db rk356x_spl_loader_ddr1056_v1.10.111.bin
</code></pre><p>Nun kann das Debian OS Image von GitHub heruntergeladen und entpackt werden:</p><pre><code>wget https://github.com/radxa-build/radxa-cm3-io/releases/download/20221101-0118/radxa-cm3-io-debian-bullseye-xfce4-arm64-20221101-0302-gpt.img.xz

xz -d radxa-cm3-io-debian-bullseye-xfce4-arm64-20221101-0302-gpt.img.xz
</code></pre><p>Abschließend wird das Debian-Image über den Loader in den eMMC Flash geschrieben:</p><pre><code>sudo rkdeveloptool wl 0 radxa-cm3-io-debian-bullseye-xfce4-arm64-20221101-0302-gpt.img
</code></pre><p>&mldr; und der SoC neu gestartet:</p><pre><code>sudo rkdeveloptool rd
</code></pre><p>Nach dem Neustart sollte auf einem angesteckten HDMI Bildschirm der Bootprozess sichtbar sein. Der &ldquo;Boot&rdquo; Schalter auf dem IO Board kann nun wieder auf &ldquo;off&rdquo; gestellt werden.</p><p>Verbindet man das IO Board via Ethernet mit dem lokalen Netzwerk, ist das Radxa Modul über den Hostnamen <code>radxa-cm3-io</code> erreichbar:</p><pre><code>ssh rock@radxa-cm3-io
</code></pre><p>Standard-Logindaten sind</p><ul><li>Username: <code>rock</code></li><li>Password: <code>rock</code></li></ul><h2 id=apt-aktualisieren>APT aktualisieren
<span><a href=#apt-aktualisieren><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg></a></span></h2><p>Direkt nach der Installation konnten wir in unserem konkreten Fall keine Paketupdates für Debian einspielen, da Uhrzeit und Datum noch nicht korrekt eingestellt waren. Das ließ sich mittels</p><pre><code>sudo systemctl restart ntp.service
</code></pre><p>schnell beheben.</p><p>Zudem wurde mindestens ein APT Repository nicht also gültig erkannt, weil ein PGP-Schlüssel nicht aktuell war:</p><pre><code>$ sudo apt update &amp;&amp; apt upgrade -y

W: GPG error: http://apt.radxa.com/bullseye-stable bullseye InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY 9B98116C9AA302C7
</code></pre><p>Auch dieses Problem ließ sich mit einem einzigen Kommando schnell beseitigen:</p><pre><code>wget -O - apt.radxa.com/$(lsb_release -c -s)-stable/public.key | sudo apt-key add -
</code></pre><p>Danach funktionierte auch ein <code>sudo apt update</code> wieder einwandfrei.</p></div><div class=post-info>Von <a href=https://blog.zero-iee.com class="p-name p-author" rel=me>Thomas Leister</a><div class="post-date dt-published">2023-03-22</div><a class="post-hidden-url u-url" href=https://blog.zero-iee.com/posts/waveshare-cm4-dual-ethernet-io-board-with-radxa-rock3-cm3/>https://blog.zero-iee.com/posts/waveshare-cm4-dual-ethernet-io-board-with-radxa-rock3-cm3/</a>
<a href=https://blog.zero-iee.com class="p-name p-author post-hidden-author h-card" rel=me>Thomas Leister</a><div class=post-taxonomies><ul class=post-tags><li><a href=https://blog.zero-iee.com/tags/rockship/>#rockship</a></li><li><a href=https://blog.zero-iee.com/tags/radxa/>#radxa</a></li><li><a href=https://blog.zero-iee.com/tags/raspi/>#raspi</a></li><li><a href=https://blog.zero-iee.com/tags/raspberrypi/>#raspberrypi</a></li><li><a href=https://blog.zero-iee.com/tags/cm4/>#cm4</a></li><li><a href=https://blog.zero-iee.com/tags/cm3/>#cm3</a></li><li><a href=https://blog.zero-iee.com/tags/waveshare/>#waveshare</a></li><li><a href=https://blog.zero-iee.com/tags/computemodule/>#computeModule</a></li></ul></div></div></article></main><footer class=common-footer><ul class=language-select><li>Deutsch</li><li><a href=https://blog.zero-iee.com/en/>English</a></li></ul><div class=common-footer-bottom><div class=copyright><p>© ZERO GmbH, ZERO GmbH Team, 2023 | <a href=/impressum/>Impressum</a> | <a href=/datenschutz/>Datenschutz</a><br>Erstellt mit <a target=_blank rel="noopener noreferrer" href=https://gohugo.io/>Hugo</a>, Markdown and Git<br>Theme <a target=_blank rel="noopener noreferrer" href=https://github.com/zero-iee/hugo-theme-anubis-zero>Anubis ZERO</a> basierend auf <a href=https://github.com/Mitrichius/hugo-theme-anubis>Mitrichius/hugo-theme-anubis</a>.<br></p></div><script>const STORAGE_KEY="user-color-scheme",defaultTheme="auto-without-switcher";let currentTheme,switchButton,autoDefinedScheme=window.matchMedia("(prefers-color-scheme: dark)");const autoChangeScheme=e=>{currentTheme=e.matches?"dark":"light",document.documentElement.setAttribute("data-theme",currentTheme),changeButtonText()};document.addEventListener("DOMContentLoaded",function(){switchButton=document.querySelector(".theme-switcher"),currentTheme=detectCurrentScheme(),currentTheme=="dark"&&document.documentElement.setAttribute("data-theme","dark"),currentTheme=="auto"&&(autoChangeScheme(autoDefinedScheme),autoDefinedScheme.addListener(autoChangeScheme)),switchButton&&(changeButtonText(),switchButton.addEventListener("click",switchTheme,!1)),showContent()});function detectCurrentScheme(){return localStorage.getItem(STORAGE_KEY)?localStorage.getItem(STORAGE_KEY):defaultTheme?defaultTheme:window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":"light"}function changeButtonText(){switchButton&&(switchButton.textContent=currentTheme=="dark"?"Helles Theme":"Dunkles Theme")}function switchTheme(){currentTheme=="dark"?(localStorage.setItem(STORAGE_KEY,"light"),document.documentElement.setAttribute("data-theme","light"),currentTheme="light"):(localStorage.setItem(STORAGE_KEY,"dark"),document.documentElement.setAttribute("data-theme","dark"),currentTheme="dark"),changeButtonText()}function showContent(){document.body.style.visibility="visible",document.body.style.opacity=1}</script></div><p class="h-card vcard"><a href=https://blog.zero-iee.com class="p-name u-url url fn" rel=me>ZERO GmbH Team</a></p></footer></div></body></html>